<!DOCTYPE html>
<html>
<head>
    <title>gTTS Example</title>
</head>
<body>
    <h1>gTTS Example</h1>
    <form id="textForm">
        <textarea id="text" name="text" rows="5" cols="50"></textarea><br>
        <select id="language" name="language">
            {% for code, name in languages.items() %}
                <option value="{{ code }}">{{ name }}</option>
            {% endfor %}
        </select><br>
        <input type="submit" value="Preview">
    </form>
    <br>
    <audio id="audio" controls style="display: block;"></audio>
    <script>
        var form = document.getElementById('textForm');
        var audio = document.getElementById('audio');
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            var text = document.getElementById('text').value;
            var language = document.getElementById('language').value;
            fetch('/preview', {
                method: 'POST',
                body: new URLSearchParams({
                    text: text,
                    language: language
                })
            })
            .then(response => response.blob())
            .then(blob => {
                var audioURL = URL.createObjectURL(blob);
                audio.src = audioURL; 
                audio.play(); 
            });
        });
    </script>
</body>
</html>
